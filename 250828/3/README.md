# 모니터링 스키아로 그려보기

### 🚩목차
- 오프닝
- 기술 검토
- 문제 발생
- 전환점
- 구조 정리
- 결론


## ✅ 1. 오프닝
최근 고객사에서 `안드로이드`와 `윈도우`에서 동작되는 모니터링 어플리케이션 의뢰가 들어옴.
그로 인해서 프레임워크 선정부터 이슈현황을 공유하는 발표 입니다.


## ✅ 2. 기술검토

### 프레임워크 선정
`리액트 네이티브`, `아발로니아`, `우노`, `마우이`를 검토해봤지만, 대내외적인 상황을 고려했을 땐 `마우이`를 선택하는게 가장 현실적이였음.

### 화면비율
`안드로이드`는 16:10의 태블릿 `윈도우`는 16:9 비율을 가지고 있었으며, `ViewBox`같은 기능을 가진 컨트롤이 MAUI에서는 존재하지 않았기 때문에 고민 상황이였음.
 화면 자체로 스키아로 해보는것도 나쁘지 않다는 조언을 받아 실행

### 생각보다 쉬운 코드, 생각보다 많은 노동
`Skia`는 비하인드코드에 직접 작성해야되고, 내가 원하는 위치에 좌표(x,y), 크기(width, height)를 구현해야했고, 화면의 객체가 많으면 많을수록 코드의 라인은 점점 들어갔고, 관리하기 힘든 직전까지 갔었으나, 막바지에 중복 코드 정렬, 자주 사용되는 색채, 컨트롤은 partail class로 분리하여 작업하니 실제 보이는 코드는 별로 안보이게됨.

### 빠른 화면 렌더링
비하인드 코드작성이고, 런타임 중 실시간으로 변경된 화면코드가 적용되지 않습니다.

그렇기 때문에 화면수정 시 코드 작성 -> 빌드 -> 화면 확인을 반복작업을 진행해야함.

하지만 객체가 적을때와, 객체가 많을 때에도 큰 렌더링 차이가 보이지 않음.

## ❗3. 문제 발생
테스트 환경에서만 잘만 작동되던 앱이 배포되는 미니PC에서는 동작되지 않았음. 
여러 추측이 난무한 가운데 가장 유력했던 것은 `PC 사양 탓일까?`였음.
우선 마감일정이 촉박하니 `윈도우`만큼은 WPF로 다시 회귀,

## 🌱4. 전환점
Path 컨트롤로 일일이 화면을 그리다, 설마하는 마음에 `Skia`코드를 WPF로 그래도 옮겼음. 
`MAUI`, `Windows` 한치의 오차없는 완벽한 화면이 그려졌고, 배포 미니PC에서도 정상적으로 화면이 띄어짐.

## 🌱5. 구조 정리
각 프레임워크(`MAUI`, `Windows`)로 프로젝트를 이중으로 관리하기 힘들기 때문에 `Skia`코드 공용라이브러리만들어 화면 필요한 객체 데이터들을 관리하기로 결정하였음.

## 6. 결론
- 이번 과정을 통해 보면, 꼭 MAUI를 선택해야 할 이유는 크지 않다는 생각이 들 수도 있습니다.
- 그러나 이 경험은 단순히 MAUI에 대한 판단을 넘어, 다양한 시각을 열어주었습니다.
  - "닷넷이 아닌 다른 프레임워크를 택했다면 어땠을까?"
  - "생각보다 닷넷의 대체 프레임워크도 러닝커브가 크지 않네."
- 결국 중요한 것은 특정 프레임워크의 우열이 아니라, 주어진 상황에서 어떤 기술을 어떻게 활용할지에 대한 선택일 것

---
발표 하루 전,

 `MAUI`의 `Windows`가 미니 PC가 돌지 않았던 이유를 찾았음. 

 - 원인 [Link](https://github.com/mono/SkiaSharp/issues/3168)

 - PR [Link](https://github.com/mono/SkiaSharp/pull/3341)

- 해결 : 최신 VSC ++ 설치 또는 SkiaSharp 업데이트

---

### SkiaSharp 예제 코드
- 그래도 난 런타임 중에 코드를 수정하고 싶다..! (핫리로드의 문제를 MetaHandler로 통해 구현)
- 마우이랑 윈도우 어떻게 공용코드를 만들었는데?!

위 바탕으로 만들어진 샘플입니다. [Link](https://github.com/lukewire129/SkiaSample)
